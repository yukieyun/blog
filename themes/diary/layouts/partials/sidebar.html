<div id="sideContainer" class="side-container">
    <div>
        {{ if and (isset .Site.Params "googlesearchcode")}}
        <script async src="https://cse.google.com/cse.js?cx={{.Site.Params.googleSearchCode}}"></script>
        <div class="gcse-searchbox-only" mobileLayout="true"></div>
        {{ end }}
    </div>
    {{ if eq .Title .Site.Title}}
    <a class="a-block nav-head active" href="{{ "" | absLangURL }}">
    {{ else }}
    <a class="a-block nav-head false" href="{{ "" | absLangURL }}">
    {{ end }}
        <div class="nav-title">
            {{.Site.Title}}
        </div>
        {{ with .Site.Params.subtitle }}
        <div class="nav-subtitle">
            {{.}}
        </div>
        {{ end }}
        <div style="display: none;"> 博客 云五的博客 沉默之沙
        </div> 
    </a>

    <div class="nav-link-list">
        {{ $current := .RelPermalink | absLangURL }}
        {{ range .Site.Menus.main }}
            {{ if not .HasChildren }}
                {{$actived := "false"}}
                {{if hasPrefix  $current (.URL|absLangURL)}}
                    {{$actived = "active"}}
                {{end}}
                <a class="a-block nav-link-item {{ $actived }}" href="{{ .URL }}" data-nav-link>
                    {{ .Name }}
                </a>
            {{ else }}
                <div class="nav-section">
                    <div class="nav-section-title">{{ .Name }}</div>
                    {{ range .Children }}
                        {{$actived := "false"}}
                        {{if hasPrefix  $current (.URL|absLangURL)}}
                            {{$actived = "active"}}
                        {{end}}
                        <a class="a-block nav-link-item {{ $actived }}" href="{{ .URL }}" data-nav-link>
                            {{ .Name }}
                        </a>
                    {{ end }}
                </div>
            {{ end }}
        {{ end }}
    </div>

    

    <div class="nav-footer">
        {{partial "copyright.html" .}}
    </div>
    
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const navLinks = document.querySelectorAll('[data-nav-link]');
    
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            const href = this.getAttribute('href');
            
            // Handle external links and RSS feeds normally
            if (href.startsWith('http') || href.endsWith('.xml') || href.includes('//')) {
                return true; // Let the default link behavior happen
            }
            
            e.preventDefault();
            
            // Update active states
            navLinks.forEach(l => l.classList.remove('active'));
            this.classList.add('active');
            
            // Update URL without page reload
            window.history.pushState({}, '', href);
            
            // Fetch and update content
            fetch(href)
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const newContent = doc.querySelector('.stream-container');
                    const currentContent = document.querySelector('.stream-container');
                    
                    if (newContent && currentContent) {
                        currentContent.innerHTML = newContent.innerHTML;
                    }
                })
                .catch(error => {
                    console.error('Error fetching content:', error);
                    // Fallback to normal navigation if fetch fails
                    window.location.href = href;
                });
        });
    });
});
</script>